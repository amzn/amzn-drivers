macOS kernel extension for Elastic Network Adapter (ENA) family:
================================================================

Version:
========
v1.5.0

Supported macOS Versions:
=========================
- macOS Mojave   10.14.x
- macOS Catalina 10.15.x

Overview:
=========
ENA is a networking interface designed to make good use of modern CPU
features and system architectures.

The ENA device exposes a lightweight management interface with a
minimal set of memory mapped registers and extendable command set
through an Admin Queue.

Driver compilation:
===================
Prerequisites:
--------------
Compatible macOS SDK and Xcode
i.e.	for macOS 10.14.6, use Xcode 10.3
	for macOS 10.15.7, use Xcode 12.1

Compilation:
------------
1. Enter the ena directory and execute xcodebuild:
$ cd amzn-drivers/kernel/macOS/ena/
$ xcodebuild
2. When xcodebuild completes the compilation, AmazonENAEthernet.kext is created inside the folder build/Release/

* The driver is not signed and can't be loaded without SIP (System Integrity Protection) disabled.

Driver installation:
====================
Adjusting the driver for loading:
---------------------------------
$ cd ./build/Release/
$ sudo chown -R root:wheel AmazonENAEthernet.kext

Loading driver (Kernel extension):
----------------------------------
$ sudo kextload AmazonENAEthernet.kext

For automatic driver load upon OS boot:
---------------------------------------
$ sudo cp -r AmazonENAEthernet.kext /Library/Extensions

ENA Source Code Directory Structure:
====================================
ENA.[cpp|hpp]				- Main macOS kernel driver.
ENAHash.[cpp|hpp]			- ENAHash class, interface for calculating hash for packets.
ENALogs.hpp				- Definition of the logging functions.
ENANaiveHash.[cpp|hpp]			- ENANaiveHash class, implements naive hash calculation.
ENAParallelOutputQueue.[cpp|hpp]	- ENAParallelOutputQueue class, responsible for the Output queue (TX).
ENAProperties.[cpp|hpp]			- ENAProperties class, holds the ENA statistics / properties reported to the OS.
ENARings.[cpp|hpp]			- Rings-related classes, holds the data structures for the I/O flows.
ENATask.[cpp|hpp]			- ENATask class, a mechanism for handling tasks asynchronously.
ENATime.hpp				- ENATime class, responsible for time operations.
ENAToeplitzHash.[cpp|hpp]		- ENAToeplitzHash class, implements Toeplitz hash calculation.
ENAUtils.[cpp|hpp]			- Common util functions.
Info.plist				- Information property list.
AmazonENAEthernet.xcodeproj/		- Xcode project files.
ena_com/				- ENA device hardware abstraction layer.


Driver tunables:
================
Change MTU:
-----------
The driver supports an arbitrarily large MTU with a maximum that is
negotiated with the device. The driver configures MTU using the
SetFeature command (ENA_ADMIN_MTU property).
command: networksetup -setMTU <hardwareport or device name> <value>

Statistics:
===========
The user can obtain ENA device and driver statistics using ioreg utility.
command: ioreg -n AmazonENAEthernet -r

Stateless Offloads:
===================
The ENA driver supports:
- IPv4 header checksum offload (TX only)
- TCP/UDP over IPv4 checksum offloads (TX only)
